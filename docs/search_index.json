[["gbané-2021-cholestérol-total.html", "Chapitre 11 Gbané (2021), Cholestérol total 11.1 Présentation 11.2 Les données 11.3 Semaine 3 11.4 Semaine 4 11.5 Semaine 5", " Chapitre 11 Gbané (2021), Cholestérol total 11.1 Présentation Variable explicative : diet : le régime Variable expliquée : chol_tot : la concentration en cholestérol mg/g 11.2 Les données df &lt;- read_csv(&quot;data/degg.csv&quot;) df &lt;- df %&gt;% add_column(id = 1:nrow(.), .before = 1) %&gt;% mutate(week = factor(week), diet = factor(diet)) df_copy &lt;- df # copie glimpse(df) ## Rows: 63 ## Columns: 11 ## $ id &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18~ ## $ week &lt;fct&gt; Week 3, Week 3, Week 3, Week 3, Week 3, Week 3, Week 3, Week ~ ## $ diet &lt;fct&gt; 0.15%B.o_0.45%C.l, 0.15%B.o_0.45%C.l, 0.15%B.o_0.45%C.l, 0.30~ ## $ egg &lt;dbl&gt; 10.900, 10.900, 10.840, 11.070, 11.830, 10.940, 10.000, 10.39~ ## $ shel &lt;dbl&gt; 1.310, 1.800, 1.350, 1.550, 1.930, 1.900, 1.130, 1.020, 0.980~ ## $ yol &lt;dbl&gt; 3.890, 3.750, 3.340, 3.230, 4.040, 2.860, 3.410, 3.890, 3.200~ ## $ alb &lt;dbl&gt; 5.700, 5.350, 6.150, 6.290, 5.860, 6.180, 5.460, 5.480, 5.110~ ## $ indl &lt;dbl&gt; 82.69, 82.29, 81.92, 80.82, 80.76, 80.42, 83.91, 84.56, 84.21~ ## $ inda &lt;dbl&gt; 1.13, 0.69, 0.75, 3.08, 3.32, 2.84, -0.98, -0.28, -0.47, 2.17~ ## $ indb &lt;dbl&gt; 56.98, 56.99, 58.25, 68.49, 70.23, 70.96, 45.13, 45.77, 45.39~ ## $ chol_tot &lt;dbl&gt; 22.480, 33.990, 20.800, 6.374, 3.727, 3.393, 27.830, 32.980, ~ 11.3 Semaine 3 df &lt;- df %&gt;% select(id, week, diet, chol_tot) %&gt;% filter(week == &quot;Week 3&quot;) 11.3.1 Exploration visuelle, boxplots ggplot(df, aes(x = diet, y = chol_tot)) + geom_boxplot() + theme_bw() + xlab(&quot;Régime&quot;) + ylab(&quot;Concentration en cholestérol - mg/g&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) 11.3.2 Identification des échantillons aberrants extrêmes df_out &lt;- df %&gt;% group_by(diet) %&gt;% identify_outliers(chol_tot) %&gt;% select(id, diet, chol_tot, is.outlier, is.extreme) df_out ## [1] id diet chol_tot is.outlier is.extreme ## &lt;0 rows&gt; (or 0-length row.names) =&gt; Pas dobservation aberrante extrême #df &lt;- df %&gt;% filter(! id %in% df_out$id) 11.3.3 Le modèle ANOVA lm &lt;- lm(log(chol_tot) ~ diet, data = df) Anova(lm) ## Anova Table (Type II tests) ## ## Response: log(chol_tot) ## Sum Sq Df F value Pr(&gt;F) ## diet 11.4624 6 23.343 1.561e-06 *** ## Residuals 1.1458 14 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 =&gt; Différence deffets très significative entre certains régimes sur la concentration en cholestérol. Mais vérifions la validité de lANOVA. 11.3.4 Normalité des résidus plot(lm, 2) shapiro_test(residuals(lm)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm) 0.964 0.595 11.3.5 Homogénéité des variances plot(lm, 3) levene_test(residuals(lm) ~ diet, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 6 14 0.407 0.862 =&gt; La normalité nétait pas respectée mais la transformation log lamélioré, confirmant la différence deffets significative entre certains régimes sur le taux de cholestérol. 11.3.6 Les moyennes pour comparaison cm1 &lt;- (SNK.test(lm, &quot;diet&quot;, group = TRUE))$groups %&gt;% mutate(diet = rownames(.)) colnames(cm1) &lt;- c(&quot;chol_tot&quot;, &quot;groups&quot;, &quot;diet&quot;) cm1 ## chol_tot groups diet ## YC 3.975425 a YC ## 0.45%B.o_0.15%C.l 3.511560 a 0.45%B.o_0.15%C.l ## 0.6%B.o 3.439720 a 0.6%B.o ## 0.6%C.l 3.411124 a 0.6%C.l ## WC 3.269569 a WC ## 0.15%B.o_0.45%C.l 3.224548 a 0.15%B.o_0.45%C.l ## 0.30%B.o_0.30%C.l 1.463182 b 0.30%B.o_0.30%C.l =&gt; Regroupement presquidentique à celui du test non paramétrique ! 11.3.7 Graphe avec les comparaisons ggplot(cm1, aes(x = diet, y = chol_tot)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 5) + theme_bw() + xlab(&quot;Régime&quot;) + ylab(&quot;Log(concentration en cholestérol - mg/g)&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = groups), vjust = -0.5, size = 4) 11.4 Semaine 4 df &lt;- df_copy %&gt;% select(id, week, diet, chol_tot) %&gt;% filter(week == &quot;Week 4&quot;) 11.4.1 Exploration visuelle, boxplots ggplot(df, aes(x = diet, y = chol_tot)) + geom_boxplot() + theme_bw() + xlab(&quot;Régime&quot;) + ylab(&quot;Concentration en cholestérol - mg/g&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) 11.4.2 Identification des échantillons aberrants extrêmes df_out &lt;- df %&gt;% group_by(diet) %&gt;% identify_outliers(chol_tot) %&gt;% select(id, diet, chol_tot, is.outlier, is.extreme) df_out ## [1] id diet chol_tot is.outlier is.extreme ## &lt;0 rows&gt; (or 0-length row.names) =&gt; Pas dobservation aberrante extrême #df &lt;- df %&gt;% filter(! id %in% df_out$id) 11.4.3 Le modèle ANOVA lm &lt;- lm(chol_tot ~ diet, data = df) Anova(lm) ## Anova Table (Type II tests) ## ## Response: chol_tot ## Sum Sq Df F value Pr(&gt;F) ## diet 4213.2 6 49.481 1.248e-08 *** ## Residuals 198.7 14 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 À ce stade, certains régimes se distinguent par une différence deffets très significative sur la concentration en cholestérol. Mais vérifions la validité de lANOVA. 11.4.4 Normalité des résidus plot(lm, 2) shapiro_test(residuals(lm)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm) 0.954 0.407 11.4.5 Homogénéité des variances plot(lm, 3) levene_test(residuals(lm) ~ diet, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 6 14 0.447 0.835 La normalité supposée respectée (à la faveur des tests). ANOVA valide. 11.4.6 Comparaisons par paires cm &lt;- (SNK.test(lm, &quot;diet&quot;, group = TRUE))$groups %&gt;% mutate(diet = rownames(.)) %&gt;% select(diet, chol_tot, groups) %&gt;% as_tibble() cm ## # A tibble: 7 x 3 ## diet chol_tot groups ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 0.30%B.o_0.30%C.l 59.4 a ## 2 YC 32.5 b ## 3 WC 32.4 b ## 4 0.15%B.o_0.45%C.l 25.5 bc ## 5 0.6%C.l 19.2 cd ## 6 0.45%B.o_0.15%C.l 17.8 cd ## 7 0.6%B.o 14.0 d 11.4.7 Graphe avec les comparaisons ggplot(cm, aes(x = diet, y = chol_tot)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 65) + theme_bw() + xlab(&quot;Régime&quot;) + ylab(&quot;Concentration en cholestérol - mg/g&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = groups), vjust = -0.5, size = 4) 11.5 Semaine 5 df &lt;- df_copy %&gt;% select(id, week, diet, chol_tot) %&gt;% filter(week == &quot;Week 5&quot;) 11.5.1 Exploration visuelle, boxplots ggplot(df, aes(x = diet, y = chol_tot)) + geom_boxplot() + theme_bw() + xlab(&quot;Régime&quot;) + ylab(&quot;Concentration en cholestérol - mg/g&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) 11.5.2 Identification des échantillons aberrants extrêmes df_out &lt;- df %&gt;% group_by(diet) %&gt;% identify_outliers(chol_tot) %&gt;% select(id, diet, chol_tot, is.outlier, is.extreme) df_out ## [1] id diet chol_tot is.outlier is.extreme ## &lt;0 rows&gt; (or 0-length row.names) =&gt; Pas dobservation aberrante extrême #df &lt;- df %&gt;% filter(! id %in% df_out$id) 11.5.3 Le modèle ANOVA lm &lt;- lm(chol_tot ~ diet, data = df) Anova(lm) ## Anova Table (Type II tests) ## ## Response: chol_tot ## Sum Sq Df F value Pr(&gt;F) ## diet 791.07 6 60.723 3.202e-09 *** ## Residuals 30.40 14 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 =&gt; Différence deffets très significative sur la concentration en cholestérol entre certains régimes. Mais vérifions la validité de lANOVA. 11.5.4 Normalité des résidus plot(lm, 2) shapiro_test(residuals(lm)) ## # A tibble: 1 x 3 ## variable statistic p.value ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 residuals(lm) 0.982 0.949 11.5.5 Homogénéité des variances plot(lm, 3) levene_test(residuals(lm) ~ diet, data = df) ## # A tibble: 1 x 4 ## df1 df2 statistic p ## &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 6 14 0.221 0.963 La conclusion de lANOVA peut être considérée valide : =&gt; Différence deffet très significative entre certains régimes sur la concentration en cholestérol à cette date. 11.5.6 Comparaisons par paires cm &lt;- (SNK.test(lm, &quot;diet&quot;, group = TRUE))$groups %&gt;% mutate(diet = rownames(.)) %&gt;% select(diet, chol_tot, groups) %&gt;% as_tibble() cm ## # A tibble: 7 x 3 ## diet chol_tot groups ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 WC 27.0 a ## 2 0.45%B.o_0.15%C.l 23.7 b ## 3 0.6%B.o 22.5 bc ## 4 0.15%B.o_0.45%C.l 20.1 c ## 5 0.6%C.l 19.6 c ## 6 YC 14.8 d ## 7 0.30%B.o_0.30%C.l 6.95 e 11.5.7 Graphe avec les comparaisons ggplot(cm, aes(x = diet, y = chol_tot)) + geom_bar(stat = &quot;identity&quot;, color = &quot;blue&quot;, fill = &quot;grey&quot;, width = 0.6) + ylim(0, 35) + theme_bw() + xlab(&quot;Régime&quot;) + ylab(&quot;Concentration en cholestérol - mg/g&quot;) + theme(axis.text.x = element_text(angle = 45, color = &quot;black&quot;, vjust = 1, hjust = 1)) + geom_text(aes(label = groups), vjust = -0.5, size = 4) 11.5.8 Évolution de la concentration en cholestérol dans le temps selon les régimes df_ic &lt;- summarySE(df_copy, measurevar = &quot;chol_tot&quot;, groupvars = c(&quot;week&quot;, &quot;diet&quot;)) #write_csv(df_ic, &quot;tab/chol_moy_temps.csv&quot;) df_ic ## week diet N chol_tot sd se ci ## 1 Week 3 0.15%B.o_0.45%C.l 3 25.756667 7.1795845 4.1451350 17.835077 ## 2 Week 3 0.30%B.o_0.30%C.l 3 4.498000 1.6332241 0.9429424 4.057154 ## 3 Week 3 0.45%B.o_0.15%C.l 3 34.330000 9.6686142 5.5821770 24.018169 ## 4 Week 3 0.6%B.o 3 31.566667 6.1702215 3.5623790 15.327680 ## 5 Week 3 0.6%C.l 3 30.356667 2.2808843 1.3168692 5.666031 ## 6 Week 3 WC 3 26.876667 6.6315936 3.8287523 16.473792 ## 7 Week 3 YC 3 57.030000 25.3856869 14.6564332 63.061542 ## 8 Week 4 0.15%B.o_0.45%C.l 3 25.516667 3.5132084 2.0283518 8.727294 ## 9 Week 4 0.30%B.o_0.30%C.l 3 59.406667 6.3204536 3.6491156 15.700877 ## 10 Week 4 0.45%B.o_0.15%C.l 3 17.836667 0.4907477 0.2833333 1.219085 ## 11 Week 4 0.6%B.o 3 14.035333 3.6496281 2.1071138 9.066179 ## 12 Week 4 0.6%C.l 3 19.203333 3.6511688 2.1080033 9.070006 ## 13 Week 4 WC 3 32.413333 4.4511160 2.5698530 11.057185 ## 14 Week 4 YC 3 32.486667 0.5870548 0.3389362 1.458325 ## 15 Week 5 0.15%B.o_0.45%C.l 3 20.123333 1.3625833 0.7866879 3.384845 ## 16 Week 5 0.30%B.o_0.30%C.l 3 6.945667 1.2211439 0.7050277 3.033490 ## 17 Week 5 0.45%B.o_0.15%C.l 3 23.723333 2.3181099 1.3383614 5.758504 ## 18 Week 5 0.6%B.o 3 22.495000 0.7150000 0.4128054 1.776158 ## 19 Week 5 0.6%C.l 3 19.630000 0.5000000 0.2886751 1.242069 ## 20 Week 5 WC 3 27.040000 1.1000000 0.6350853 2.732551 ## 21 Week 5 YC 3 14.760000 2.1227576 1.2255747 5.273222 ggplot(df_ic, aes(x = week, y = chol_tot, colour = diet, group = diet)) + geom_line(size = 1) + geom_point(size = 2) + ylab(&quot;Concentration en cholestérol - mg/g&quot;) + xlab(&quot;Temps&quot;) + theme_bw() "]]
